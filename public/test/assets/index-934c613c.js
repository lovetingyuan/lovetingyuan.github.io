import{_ as y,a4 as De,bx as Ke,bJ as Me,W as ce,U as G,bK as Qe,bL as Ge,bM as We,bD as $e,k as ue,bN as Ue,bO as Ve,bP as ze,bQ as Fe,bR as se,bS as de,ag as me,bI as be,bT as He,$ as qe,bU as Xe}from"./reference-b1a48a0f-59bab03f.js";import{r as s,aO as fe,a$ as H,s as a,e as Ye,aN as L,b9 as Ze,b3 as q,aH as O,b0 as W,b1 as ve,ad as he,b2 as U,aG as ye,a4 as $}from"./entries-49a38532-6be843d0.js";var b={leftTreeRightList:"index-module_leftTreeRightList__7JJbP",treeBreadcrumb:"index-module_treeBreadcrumb__2JMIQ",treeBreadcrumbItem:"index-module_treeBreadcrumbItem__3TkRC",leftTreeRightListContent:"index-module_leftTreeRightListContent__R5O8G",emptyContent:"index-module_emptyContent__VvvWl",mgt10:"index-module_mgt10__Idhes",searchBlock:"index-module_searchBlock__IBOBt"};function pe(e,t){var n=ye(e);if($){var l=$(e);t&&(l=q(l).call(l,function(r){return U(e,r).enumerable})),n.push.apply(n,l)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n,l,r=arguments[t]!=null?arguments[t]:{};t%2?O(n=pe(Object(r),!0)).call(n,function(i){H(e,i,r[i])}):W?ve(e,W(r)):O(l=pe(Object(r))).call(l,function(i){he(e,i,U(r,i))})}return e}function Ae(e){var t=e.treeData,n=e.list,l=e.selected,r=e.setSelected,i=e.column,v=e.multi,k=e.dataReference,C=e.configInfo,f=e.clickedTreeKey,_=e.setClickedTreeKey,g=e.detailPage,u=e.onChange,d=s.exports.useState([]),j=y(d,2),E=j[0],V=j[1],z=function c(R,o){var D=[];return o.length<=0?[]:(o&&O(o).call(o,function(T){T.id===R?D=T.children||[]:T.children&&c(R,T.children)}),D)},J=function(){var c=[];c=f?z(f,t||[]):t,V(c)};return s.exports.useEffect(function(){J()},[f]),(t==null?void 0:t.length)<=0?a.createElement("div",null,n.length>0?a.createElement(s.exports.Fragment,null,L(n).call(n,function(c){return a.createElement(se,{item:c,selectedList:l,setSelectedList:r,column:i,multi:v,key:c.id,dataReference:k,detailPage:g,onChange:u})})):a.createElement(de,null)):a.createElement("div",{className:b.leftTreeRightListContent},E.length>0?a.createElement(me,null,L(E).call(E,function(c){var R;return a.createElement(me.Item,{onClick:function(){return function(o){o.id&&_(o.id)}(c)},key:c.id,extra:a.createElement(Ze,{name:"LinedElementsPortal"})},L(R=(C==null?void 0:C.treeColumns)||[]).call(R,function(o){return a.createElement("span",{style:{marginRight:"4px"},key:o.name},a.createElement(be,{value:c[o.name],dataType:o==null?void 0:o.dataType,extra:xe(xe({},o),{},{field:o.name,record:c,relationEntity:o==null?void 0:o.relationEntity})}))}))})):null,n!=null&&n.length?a.createElement("div",{className:b.mgt10},L(n).call(n,function(c){return a.createElement(se,{item:c,selectedList:l,setSelectedList:r,column:i,multi:v,key:c.id,dataReference:k,detailPage:g})})):null,E.length===0&&n.length===0?a.createElement("div",{className:b.emptyContent},a.createElement(de,null)):null)}function ge(e,t){var n=ye(e);if($){var l=$(e);t&&(l=q(l).call(l,function(r){return U(e,r).enumerable})),n.push.apply(n,l)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n,l,r=arguments[t]!=null?arguments[t]:{};t%2?O(n=ge(Object(r),!0)).call(n,function(i){H(e,i,r[i])}):W?ve(e,W(r)):O(l=ge(Object(r))).call(l,function(i){he(e,i,U(r,i))})}return e}function et(e){var t=e.clickedTreeKey,n=e.setClickedTreeKey;e.treeData;var l=e.treeColumns,r=e.treeList,i=s.exports.useState([]),v=y(i,2),k=v[0],C=v[1];return s.exports.useEffect(function(){if(t){var f,_=He(t,r);_&&C(q(f=_.split("/")).call(f,function(g){return g!=="0"&&g}))}},[t]),a.createElement("div",{className:b.treeBreadcrumb},a.createElement("span",{className:b.treeBreadcrumbItem,onClick:function(){t&&(n(""),C([]))}},qe.t({k:"user.menu.all",d:"全部"})),L(k).call(k,function(f){return a.createElement("span",{key:f,className:b.treeBreadcrumbItem,onClick:function(){f!==t&&n(f)}},function(_){var g,u=Xe(_,r)||{};return L(g=l||[]).call(g,function(d){return a.createElement("span",{style:{marginRight:"4px"},key:d.name},a.createElement(be,{value:u==null?void 0:u[d==null?void 0:d.name],dataType:d==null?void 0:d.dataType,extra:_e(_e({},d),{},{field:d.name,record:u,relationEntity:d==null?void 0:d.relationEntity})}))})}(f))}))}function at(e){var t,n,l,r=e.multiSelect,i=r!==void 0&&r,v=e.selected,k=v===void 0?[]:v,C=e.setSelected,f=e.onChange,_=e.column,g=_===void 0?[]:_,u=e.dataReference,d=e.fixedOrders,j=e.output,E=e.detailPage,V=e.columnsShowOne2ManyDto,z=e.pageProps,J=e.fixedCond,c=e.visible,R=e.applicationName,o=e.remoteComponent,D=s.exports.useState(!0),T=y(D,2),ke=T[0],K=T[1],Ce=s.exports.useState([]),X=y(Ce,2),Ee=X[0],Re=X[1],Te=s.exports.useState([]),Y=y(Te,2),Z=Y[0],Ie=Y[1],we=s.exports.useState(""),A=y(we,2),B=A[0],ee=A[1],Be=s.exports.useState([]),te=y(Be,2),Le=te[0],Je=te[1],m=u.configInfo||{},F=m==null||(t=m.treeConfig)===null||t===void 0?void 0:t.treeEntityReferenceColFiled,Ne=s.exports.useState(null),ne=y(Ne,2),N=ne[0],Pe=ne[1],ae=s.exports.useContext(De).appData,le=s.exports.useContext(Ke).pageId,Se=Me(F,m.treeColumns||[]),Oe=s.exports.useCallback(function(){var x=ce(G.mark(function M(P){var I,w,h,re,S,ie,oe,Q;return G.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return K(!0),w={and:N!=null&&N.length?N:[]},F&&B&&(re=fe(h="EQ_".concat(Ge(u.entityName),"Dto_")).call(h,F),w.and.push(H({},re,B))),S=[],(I=w.and)!==null&&I!==void 0&&I.length&&S.push(w),p.prev=5,p.next=8,We({params:{pageInfo:P,dynamicSearchKeyCond:S!=null&&S.length?S:null,fixedCond:J!=null&&J.length?J:null,fixedOrders:d!=null&&d.length?d:null},entity:$e(u,fe(ie=[]).call(ie,ue(j||[]),ue(Se||[])),E),dataReference:u,pageProps:z,appData:ae,pageId:le});case 8:oe=p.sent,Q=oe.content,Q=Qe(Q,m==null?void 0:m.currentId,V||""),Re(Q),p.next=17;break;case 14:p.prev=14,p.t0=p.catch(5),console.error(p.t0);case 17:return p.prev=17,K(!1),p.finish(17);case 20:case"end":return p.stop()}},M,null,[[5,14,17,20]])}));return function(M){return x.apply(this,arguments)}}(),[u.entityName,B,N]),je=function(){var x=ce(G.mark(function M(){var P,I,w;return G.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return K(!0),h.next=3,Ve({entityName:((P=m.treeConfig)===null||P===void 0?void 0:P.treeEntityName)||"",columns:m.treeColumns||[],appInfo:u.appInfo,dataReference:u,appData:ae,pageId:le});case 3:I=h.sent,w=Ue(I,"treeParentId","0"),Je(I),Ie(w),K(!1);case 8:case"end":return h.stop()}},M)}));return function(){return x.apply(this,arguments)}}();return s.exports.useEffect(function(){var x;m!=null&&(x=m.treeConfig)!==null&&x!==void 0&&x.treeEntityName&&je()},[m==null||(n=m.treeConfig)===null||n===void 0?void 0:n.treeEntityName]),s.exports.useEffect(function(){Oe(ze)},[c,B,N]),a.createElement("div",{className:b.referenceModalList},a.createElement("div",{className:b.leftTreeRightList},a.createElement("div",null,a.createElement(Fe,{columns:(u==null||(l=u.configInfo)===null||l===void 0?void 0:l.search)||[],onSearch:function(x){Pe((x==null?void 0:x.length)<=0?null:x)},applicationName:R,remoteComponent:o})),a.createElement(et,{clickedTreeKey:B,setClickedTreeKey:ee,treeData:Z,treeColumns:(m==null?void 0:m.treeColumns)||[],treeList:Le}),ke?a.createElement("div",{className:b.loadingContent}):a.createElement(Ae,{treeData:Z,list:Ee,selected:k,setSelected:C,column:g,multi:i,dataReference:u,configInfo:m,clickedTreeKey:B,setClickedTreeKey:ee,detailPage:E,onChange:f})))}Ye('.index-module_leftTreeRightList__7JJbP{-webkit-box-orient:vertical;-webkit-box-direction:normal;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:100%}.index-module_leftTreeRightList__7JJbP .index-module_treeBreadcrumb__2JMIQ{-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:30px;overflow-x:auto;white-space:nowrap;width:100%}.index-module_leftTreeRightList__7JJbP .index-module_treeBreadcrumb__2JMIQ .index-module_treeBreadcrumbItem__3TkRC:not(:last-child):after{color:#ddd;content:">";cursor:auto;margin:0 4px}.index-module_leftTreeRightList__7JJbP .index-module_treeBreadcrumb__2JMIQ .index-module_treeBreadcrumbItem__3TkRC:first-child,.index-module_leftTreeRightList__7JJbP .index-module_treeBreadcrumb__2JMIQ .index-module_treeBreadcrumbItem__3TkRC:not(:last-child){color:#586a95}.index-module_leftTreeRightList__7JJbP .index-module_leftTreeRightListContent__R5O8G{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow:auto}.index-module_leftTreeRightList__7JJbP .index-module_leftTreeRightListContent__R5O8G .index-module_emptyContent__VvvWl{-webkit-box-pack:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:100%;-webkit-justify-content:center;justify-content:center}.index-module_mgt10__Idhes{margin-top:12px}.index-module_searchBlock__IBOBt{margin:5px 0;padding:0 16px}.index-module_searchBlock__IBOBt .adm-search-bar{pointer-events:none}');export{at as default};
