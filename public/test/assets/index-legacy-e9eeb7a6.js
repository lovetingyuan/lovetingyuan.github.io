System.register(["./entries-49a38532-legacy-a7c3725c.js","./reference-b1a48a0f-legacy-578a01e1.js"],(function(e,t){"use strict";var n,a,l,i,r,o,c,u,d,s,m,p,f,b,x,v,k,h,w,_,y,g,C,E,S,N,I,L,j,J,P,R,Y,O,B,z,D,X,G,U,W,F,T;return{setters:[e=>{n=e.e,a=e.r,l=e.aO,i=e.aY,r=e.s,o=e.aN,c=e.aa,u=e.b3,d=e.bb,s=e.b9,m=e.aH,p=e.a$,f=e.b0,b=e.b1,x=e.ad,v=e.b2,k=e.aS,h=e.aG,w=e.a4},e=>{_=e._,y=e.a4,g=e.bx,C=e.W,E=e.U,S=e.k,N=e.by,I=e.bz,L=e.bA,j=e.bB,J=e.bC,P=e.bD,R=e.bE,Y=e.br,O=e.$,B=e.v,z=e.bF,D=e.bG,X=e.S,G=e.bH,U=e.bI,W=e.R,F=e.X,T=e.ap}],execute:function(){e("default",(function(e){var t,n=e.multiSelect,d=void 0!==n&&n,s=e.onChange,m=e.dataReference,p=e.output,f=void 0===p?[]:p,b=e.pageProps,x=e.onOk,v=e.detailPage,k=e.selected,h=void 0===k?[]:k,w=b||{},X=w.uiModelParams,W=w.itemContext,F=w.execSyncWithCompile,q=a.exports.useState([]),A=_(q,2),H=A[0],K=A[1],V=a.exports.useState([]),Z=_(V,2),ee=Z[0],te=Z[1],ne=a.exports.useState(!1),ae=_(ne,2),le=ae[0],ie=ae[1],re=a.exports.useState([]),oe=_(re,2),ce=oe[0],ue=oe[1],de=m.configInfo||{},se=null==de?void 0:de.onlyLastLevel,me=(null==m||null===(t=m.configInfo)||void 0===t?void 0:t.columns)||[],pe=a.exports.useContext(y).appData,fe=a.exports.useContext(g).pageId,be=function(e){!function(e,t){d?(e?h.push(t):h=u(h).call(h,(function(e){return(null==t?void 0:t.id)!==e.id})),null==s||s(S(h))):null==s||s(e?[t]:[])}(!(T(h).call(h,(function(t){return(null==t?void 0:t.id)===e.id}))>-1),e)},xe=function(e,t){var n=G(t,e.name);return r.createElement(U,{value:n,dataType:null==e?void 0:e.dataType,extra:Q(Q({},e),{},{field:e.name,record:t,relationEntity:null==e?void 0:e.relationEntity})})},ve=function(){var e=C(E.mark((function e(t){var n,a;return E.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue((function(e){var n;return l(n=[]).call(n,S(e),[{id:t.id,key:t.id,record:t,pathName:xe(me,t||{})}])})),null!==(n=t.children)&&void 0!==n&&n.length||t.isLeaf){e.next=6;break}return e.next=4,we({treeParentId:t.id});case 4:a=e.sent,K(l(H).call(H,a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=a.exports.useMemo((function(){var e=i(ce).call(ce,-1),t=_(e,1)[0];return null!=H&&H.length?N({flatData:H,rootId:null==t?void 0:t.id}):[]}),[ce,H]),he=function(e){if(e){var t=T(ce).call(ce,(function(t){return t.id===e.id}));ue(i(ce).call(ce,0,t+1))}else ue([])},we=a.exports.useCallback(C(E.mark((function e(){var t,n,a,i,r,o,c,u,d,s,p,b,x,k=arguments;return E.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.length>0&&void 0!==k[0]?k[0]:{},n=t.treeParentId,a=void 0===n?"0":n,i=t.search,r=t.params,o=void 0===r?{}:r,e.prev=1,L(null==m?void 0:m.appInfo),u={queryDto:Q({sqlModel:j(P(m,f,v),J(null==m?void 0:m.appInfo)),sort:{orders:[{direction:"ASC",property:"archiveCode"}]},treeParentId:a,limit:1e3},o)},"0"===a&&i&&(u.queryDto.locationCond={archiveCaption:i}),e.prev=5,null==m||null===(d=m.configInfo)||void 0===d||!d.whereCond){e.next=13;break}if(!(p=JSON.parse(null==m||null===(s=m.configInfo)||void 0===s?void 0:s.whereCond))||!p.length){e.next=13;break}return e.next=11,R(p,X,W,F);case 11:b=e.sent,u.queryDto.filterCond=b;case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(5);case 17:return e.next=19,I({columns:l(c=[]).call(c,S(me),S(f)),entityName:null==m?void 0:m.entityName,serverParams:u,appInfo:(null==m?void 0:m.appInfo)||{},dataReference:m,appData:pe,pageId:fe});case 19:return x=e.sent,e.abrupt("return",x);case 23:return e.prev=23,e.t1=e.catch(1),e.abrupt("return",[]);case 26:case"end":return e.stop()}}),e,null,[[1,23],[5,15]])}))),[m,f,me]),_e=function(){var e=C(E.mark((function e(t){var n;return E.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we({search:t,params:{needParentAndBrother:!1,limit:1e3,extendCond:se?{isLeaf:!0}:void 0}});case 3:n=e.sent,te(n),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return a.exports.useEffect((function(){C(E.mark((function e(){var t;return E.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we();case 2:t=e.sent,K(t);case 4:case"end":return e.stop()}}),e)})))()}),[we]),r.createElement(a.exports.Fragment,null,r.createElement("div",{className:"index-module_searchBlock__NfBmY",onClick:function(){ie(!0)}},r.createElement(Y,{placeholder:O.t({k:"common.search.label",d:"搜索"})})),r.createElement("div",{className:"index-module_breadcrumb__tmIXo"},r.createElement("div",{key:"ROOT",className:"crumbs-item root",onClick:function(){return he()}},O.t({k:"common.reference.rootDirectory",d:"根目录"})),o(ce).call(ce,(function(e,t){return r.createElement("div",{key:e.key,className:"crumbs-item"},r.createElement("span",{className:"split"},"/"),r.createElement("span",{onClick:function(){return he(e)},className:c("pathName",{current:t===ce.length-1})},o(me).call(me,(function(t){return r.createElement("span",{key:t.name,style:{marginRight:"4px"}},xe(t,(null==e?void 0:e.record)||{})," ")}))))}))),r.createElement("div",{className:"index-module_listWrapper__8JNuF"},o(ke).call(ke,(function(e){var t;return r.createElement(M,{key:e.id,item:e,columns:(null==m||null===(t=m.configInfo)||void 0===t?void 0:t.columns)||[],selected:B(h).call(h,(function(t){return(null==t?void 0:t.id)===e.id})),selectable:!(se&&!e.isLeaf),onSelect:be,dataReference:m,onChildren:ve,isLeaf:e.isLeaf,detailPage:v,multiSelect:d})}))),r.createElement($,{visible:le,dataReference:m,columns:me,dataSource:ee,onCancel:function(){ie(!1)},onSearch:_e,onOk:function(e){if(d){var t,n=new z(o(e).call(e,(function(e){return[e.id,e]}))),a=u(e).call(e,(function(e){return!n.has(e.id)}));x(D(l(t=[]).call(t,S(e),S(a)),f))}else x(D(e,f))},detailPage:v,multiSelect:d}))})),n(".index-module_container__JwCjl{-webkit-box-orient:vertical;-webkit-box-direction:normal;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:90%}.index-module_searchBlock__NfBmY{margin:5px 0;padding:0 16px}.index-module_searchBlock__NfBmY .adm-search-bar{pointer-events:none}.index-module_breadcrumb__tmIXo{-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:30px;overflow-x:auto;padding:0 20px;white-space:nowrap;width:100%}.index-module_breadcrumb__tmIXo .crumbs-item{font-size:14px}.index-module_breadcrumb__tmIXo .crumbs-item.root{color:var(--adm-color-primary)}.index-module_breadcrumb__tmIXo .crumbs-item .split{margin:0 8px}.index-module_breadcrumb__tmIXo .crumbs-item .pathName{color:var(--adm-color-primary)}.index-module_breadcrumb__tmIXo .crumbs-item .pathName.current{color:#131f31}.index-module_listWrapper__8JNuF{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow-y:auto;padding:0 20px}.index-module_buttonGroups__JnhbF{-webkit-box-pack:justify;-webkit-box-align:center;-webkit-align-items:center;align-items:center;color:var(--adm-color-primary,#00a0b4);display:-webkit-box;display:-webkit-flex;display:flex;font-size:14px;height:50px;-webkit-justify-content:space-between;justify-content:space-between;padding:5px 12px;width:100%}"),n(".index-module_item__eoUiw{-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;padding:12px 0}.index-module_item__eoUiw .desc{-webkit-box-flex:1;color:#131f31;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex:1;flex:1;-webkit-flex-wrap:wrap;flex-wrap:wrap;font-size:16px;font-weight:400;margin-left:14px;word-break:break-word}.index-module_item__eoUiw .desc-item{margin-right:10px}.index-module_item__eoUiw .desc-item.hasLink{color:var(--adm-color-primary);cursor:pointer;text-decoration:underline}.index-module_searchContainer__oYJL4{-webkit-box-orient:vertical;-webkit-box-direction:normal;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:100%}.index-module_searchContainer__oYJL4 .search{-webkit-box-align:center;-webkit-box-pack:justify;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;margin:20px 0 5px;padding:0 16px}.index-module_searchContainer__oYJL4 .searchBar{-webkit-box-flex:1;-webkit-flex:1;flex:1}.index-module_searchContainer__oYJL4 .searchConfirm{color:var(--text-color);-webkit-flex-shrink:0;flex-shrink:0;padding:0 10px}.index-module_searchContainer__oYJL4 .listWrapper{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow-y:auto;padding:0 20px}.index-module_searchContainer__oYJL4 .buttonGroups{-webkit-box-pack:justify;-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:50px;-webkit-justify-content:space-between;justify-content:space-between;padding:5px 12px;width:100%}.index-module_searchContainer__oYJL4 .buttonGroups .adm-buttonl{width:-webkit-calc(50vw - 24px);width:calc(50vw - 24px)}");var t=["columns","item","selected","selectable","isLeaf"];function q(e,t){var n=h(e);if(w){var a=w(e);t&&(a=u(a).call(a,(function(t){return v(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n,a,l=null!=arguments[t]?arguments[t]:{};t%2?m(n=q(Object(l),!0)).call(n,(function(t){p(e,t,l[t])})):f?b(e,f(l)):m(a=q(Object(l))).call(a,(function(t){x(e,t,v(l,t))}))}return e}var M=function(e){var n=e.columns,a=e.item,l=e.selected,i=e.selectable,c=e.isLeaf,u=d(e,t);return r.createElement("div",{className:"index-module_item__eoUiw"},i?r.createElement(X,{checked:!!l,onChange:function(e){u.onSelect(a,e)}}):null,r.createElement("div",{className:"desc",onClick:function(){i&&u.onSelect(a,!l)}},o(n).call(n,(function(e){return r.createElement("span",{key:e.name,style:{marginRight:"4px"}},function(e,t){var n=G(t,e.name);return r.createElement(U,{value:n,dataType:null==e?void 0:e.dataType,extra:A(A({},e),{},{field:e.key,record:t,relationEntity:null==e?void 0:e.relationEntity})})}(e,a)," ")}))),c?null:r.createElement(s,{onClick:function(){var e;return null==u||null===(e=u.onChildren)||void 0===e?void 0:e.call(u,a)},name:"LinedRight",style:{color:"#C8C8C8",fontSize:16}}))},H=["visible","dataReference","multiSelect","dataSource","columns","detailPage"],$=function(e){var t=e.visible,n=e.dataReference,l=e.multiSelect,c=e.dataSource,u=e.columns,s=e.detailPage,m=d(e,H),p=a.exports.useState([]),f=_(p,2),b=f[0],x=f[1],v=a.exports.useState(""),h=_(v,2),w=h[0],y=h[1],g=function(e){var t=T(b).call(b,(function(t){return t.id===e.id}));if(t>-1)k(b).call(b,t,1),x(i(b).call(b));else{var n=[];l?(n=b).push(e):n.push(e),x(n)}};return r.createElement(W,{visible:t,bodyStyle:{height:"100vh"},style:{zIndex:1e4}},r.createElement("div",{className:"index-module_searchContainer__oYJL4"},r.createElement("div",{className:"search"},r.createElement(Y,{className:"searchBar",placeholder:O.t({k:"app_common.input",d:"请输入"}),clearable:!0,value:w,onChange:function(e){return y(e)},onSearch:function(e){var t;null==m||null===(t=m.onSearch)||void 0===t||t.call(m,e)}}),r.createElement("div",{className:"searchConfirm",onClick:function(){var e;null==m||null===(e=m.onSearch)||void 0===e||e.call(m,w)}},O.t({k:"common.search.label",d:"搜索"}))),r.createElement("div",{className:"listWrapper"},o(c).call(c,(function(e){return r.createElement(M,{key:e.id,item:e,columns:u,selected:B(b).call(b,(function(t){return t.id===e.id})),selectable:!0,onSelect:g,dataReference:n,isLeaf:!0,detailPage:s})}))),r.createElement("div",{className:"buttonGroups"},r.createElement(F,{block:!0,size:"large",fill:"outline",style:{marginRight:"8px"},onClick:function(){var e;null==m||null===(e=m.onCancel)||void 0===e||e.call(m)}},O.t({k:"common.button.cancel.label",d:"取消"})),r.createElement(F,{block:!0,size:"large",disabled:!b.length,onClick:function(){var e;null==m||null===(e=m.onOk)||void 0===e||e.call(m,b)}},O.t({k:"common.button.ok.label",d:"确定"})))))};function K(e,t){var n=h(e);if(w){var a=w(e);t&&(a=u(a).call(a,(function(t){return v(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n,a,l=null!=arguments[t]?arguments[t]:{};t%2?m(n=K(Object(l),!0)).call(n,(function(t){p(e,t,l[t])})):f?b(e,f(l)):m(a=K(Object(l))).call(a,(function(t){x(e,t,v(l,t))}))}return e}}}}));
