### dns & cdn

#### DNS

域名是分层的结构，在逻辑上组成一个树形结构，以 `foo.tingyuan.in` 举例：

- 根域名 `.`，全球一共13台，它们的IP是固定不变的
- 顶级域名 `.in`，又称TLD，分为通用顶级域名如.com,.net以及国别顶级域名如.cn,.us，.in就代表印度）
- 一级域名 `tingyuan`，是用户在顶级域名下自行注册的域名
- 二级域名 `foo`，域名拥有者自行设置即可，还可以继续设置三级域名等

域名查询需要逐级查询

1. 缓存查询（浏览器-主机-路由器-IPS提供商）
2. 向根域名服务器查询，获取顶级域名服务器IP
3. 向顶级域名服务器查询，获取一级域名服务器IP
4. 查询一级域名服务器，获取二级域名服务器IP

DNS服务器种类

- 根域名服务器
- TLD服务器
- 权威域名服务器（一级域名服务器）
- 递归域名服务器，一般是由一些第三方提供的DNS自动化查询服务，例如cloudflare提供的`1.1.1.1`，google提供的`8.8.8.8`等，它们会受理终端的DNS查询请求并且通过递归的方式去查找到最终的IP地址返回给终端

![DNS-server](https://cdn.beekka.com/blogimg/asset/202208/bg2022080112.webp)

DNS记录

DNS查询请求除了包含域名信息还可以携带记录类型，记录就是将域名映射到某个地址或资源的方式，最常用的就是A记录和CNAME记录

- A记录就是将域名指向一个IP地址，也就是DNS最原始的目的
- AAAA记录指向的是IPv6地址
- CNAME记录指向另一个域名，相当于当前域名的一个别名，DNS服务器需要去做递归查询。假设有多个域名，可以把它们设置到同一个别名，这样当主机迁移时就只需要更新别名的IP。
- MX记录，指向邮件服务器的A域名或者IP地址，专门用于电子邮件的记录类型
- NS记录，即域名服务器记录，指示哪个 DNS 服务器对该域具有权威性（即，哪个服务器包含其实际 DNS 记录）
- TXT记录，它指向的实际是一段文本，通常用来验证域名所有权或者预防垃圾邮件

另外还有一些其他类型的记录，可以参考[这里](https://www.cloudflare.com/zh-cn/learning/dns/dns-records)

DNS记录还有一个重要参数 TTL，它表示记录在DNS服务器中存留的时间，通常记录不会经常变化，所以TTL可以设置较长时间来通过缓存加快域名解析

#### CDN
