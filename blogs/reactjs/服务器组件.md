## React Server Components

React服务器组件的几个原则：

1. React 服务器组件只在服务器端运行一次，然后响应序列化后的渲染结果，这个渲染结果在客户端也不会再变化。这意味着服务器组件并不会涉及状态以及副作用。
2. 服务器组件不会打包到js bundle当中，只在服务器存在
3. 客户端组件可以在浏览器和服务器运行
4. 所有的组件默认是服务器组件，但是可以用 `"use client"` 来标记一个组件为客户端组件
5. 客户端组件只能渲染客户端组件，并且在客户端中引用的组件也都应该是客户端组件，引用的模块也都应该是客户端的模块

   ```jsx
   function Client() {
     return (
       <div>
         this is client component
         <Server /> // 不合法！！！
       </div>
     )
   }
   ```

   ```jsx
   function Client(props) {
     return (
       <div>
         this is client component
         {props.serverComponent} // ok
       </div>
     )
   }
   ```

https://sorrycc.com/why-react-server-components/

---------

# React Server Components (RSC) 的目的与优势

## 引入 RSC 的主要目的

1. **结合服务器和客户端的优势** - 创建一个统一的开发模型，让开发者能同时利用服务器和客户端各自的优势

2. **改善性能和用户体验** - 通过减少网络传输和优化渲染流程，提供更快的加载速度和响应性

3. **简化复杂应用架构** - 为开发者提供更自然的编程模型，减少在服务器和客户端之间切换的心智负担

4. **减少客户端 JavaScript 体积** - 降低需要发送到浏览器的代码量，特别是对于只需要在服务器上运行的组件

5. **提高应用可维护性** - 允许更清晰地分离关注点，使代码库更易于理解和维护

## RSC 的核心优势

### 1. 零捆绑 JavaScript 负载

- 服务器组件不需要发送到客户端，只有渲染结果被传输
- 大幅减少客户端下载、解析和执行的 JavaScript 代码量
- 特别有益于网络连接较慢或设备性能有限的用户

### 2. 直接访问后端资源

- 服务器组件可以直接访问数据库、文件系统和后端服务
- 消除了传统 API 层的需求，简化了数据获取流程
- 减少了客户端-服务器通信的往返次数

### 3. 自动代码分割

- RSC 架构自然支持细粒度的代码分割
- 客户端只接收实际需要在浏览器中运行的组件代码
- 无需手动配置复杂的代码分割策略

### 4. 流式渲染

- 支持渐进式内容流式传输到客户端
- 用户可以更快看到页面的初始内容，而不必等待所有数据加载完成
- 改善了感知性能和用户体验

### 5. 更好的安全模型

- 敏感逻辑和数据处理可以保留在服务器上
- 减少了客户端暴露的攻击面
- API 密钥和认证凭证可以安全地保存在服务器端

### 6. 跨环境组件组合

- 服务器组件和客户端组件可以无缝协作
- 开发者可以根据组件的需求选择最合适的环境
- 保持了 React 组件模型的统一性和可组合性

### 7. 更简洁的数据获取模式

- 减少了客户端状态管理的复杂性
- 无需使用 useEffect 进行数据获取
- 通过共置数据获取和组件渲染逻辑，提高了代码可维护性

### 8. SEO 和初始加载优化

- 服务器渲染确保搜索引擎能够看到完整内容
- 改善了首次内容绘制 (FCP) 和首次有意义绘制 (FMP) 指标
- 无需额外配置就能实现良好的 SEO 性能

### 9. 开发体验改进

- 统一的编程模型减少了上下文切换
- 更自然的数据获取和状态管理方式
- 简化了构建全栈 React 应用的流程

### 10. 与现有 React 生态系统兼容

- 可以逐步采用 RSC，无需一次性重写整个应用
- 现有的客户端组件可以与新的服务器组件共存
- 保持了 React 熟悉的编程模型和组件抽象

## 实际应用场景

- **内容丰富的网站** - 博客、新闻网站和内容管理系统
- **电子商务平台** - 产品列表、搜索结果和产品详情页面
- **数据密集型应用** - 仪表盘、分析工具和报表系统
- **个性化用户体验** - 根据用户数据定制内容的应用
- **大型企业应用** - 需要优化性能和维护性的复杂系统
