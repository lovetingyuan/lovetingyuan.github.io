import{_ as v,h as E}from"./index-e27243ae.js";function R(u={}){const{immediate:g=!1,onNeedRefresh:a,onOfflineReady:t,onRegistered:l,onRegisteredSW:d,onRegisterError:r}=u;let e,f,o;const p=async(c=!0)=>{await f,await(o==null?void 0:o())};async function w(){if("serviceWorker"in navigator){const{Workbox:c}=await v(()=>import("./workbox-window.prod.es5-295a6886.js"),[]);e=new c("/sw.js",{scope:"/",type:"classic"}),o=async()=>{await(e==null?void 0:e.messageSkipWaiting())};{let i=!1;const s=()=>{i=!0,e==null||e.addEventListener("controlling",n=>{n.isUpdate&&window.location.reload()}),a==null||a()};e.addEventListener("installed",n=>{typeof n.isUpdate>"u"?typeof n.isExternal<"u"?n.isExternal?s():!i&&(t==null||t()):n.isExternal?window.location.reload():!i&&(t==null||t()):n.isUpdate||t==null||t()}),e.addEventListener("waiting",s),e.addEventListener("externalwaiting",s)}e.register({immediate:g}).then(i=>{d?d("/sw.js",i):l==null||l(i)}).catch(i=>{r==null||r(i)})}}return f=w(),p}const W=R({onOfflineReady(){console.log("sw offline enabled...")},onNeedRefresh(){E.value=W,console.log("sw update")}});export{W as default};
